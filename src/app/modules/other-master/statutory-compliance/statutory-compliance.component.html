<app-leftmenu></app-leftmenu>
<form class="card" role="form" [formGroup]="form" #formDirective="ngForm" method="post" novalidate>
  <div class="page">
    <app-header></app-header>
    <div class="section-body mt-3">
      <div class="container-fluid" style="border: 1px solid #ccc; background-color: #fff;">
        <div class="tabview-contents">
          <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="card-body p-0">

                  <fieldset>
                    <legend>Institution Details</legend>

                    <div class="row">

                      <div class="col-sm-3">
                        <label class="form-label"> Code</label>
                        <input type="text" formControlName="institutionCode" class="form-control" autocomplete="off"
                          name="institutionCode">
                      </div>

                      <div class="col-sm-3">
                        <label class="form-label"> Name</label>
                        <input type="text" formControlName="institutionName" class="form-control" autocomplete="off"
                          name="companyGroupCode" placeholder="Enter Institution Name"
                          [ngClass]="{'is-invalid' : form.get('institutionName').status == 'INVALID'}">
                      </div>

                      <div class="col-sm-3">
                        <label class="form-label">Head Name</label>
                        <select name="headName" id="headName" class="form-control" formControlName="headName"
                          [ngClass]="{'is-invalid' : form.get('headName').status == 'INVALID'}"
                          (change)='onSelectHeadName($event.target.value)'>
                          <option selected value=''>Select </option>
                          <option *ngFor="let headName of headNameList" [value]="headName">
                            {{headName}}
                          </option>
                        </select>
                      </div>

                      <div class="col-sm-3">
                        <label class="form-label">Country</label>
                        <select name="country1" id="country1" class="form-control" formControlName="country1"
                          [ngClass]="{'is-invalid' : form.get('country1').status == 'INVALID'}">
                          <option selected value=''>Select </option>
                          <option *ngFor="let country of countries" [value]="country">
                            {{country}}
                          </option>
                        </select>
                      </div>


                    </div>







                    <!-- end of row -->
                    <div class="row mt-20">

                      <div class="col-sm-3">
                        <label class="form-label">Applicability Level </label>
                        <select name="applicabilityLevel" id="applicabilityLevel" class="form-control"
                          [ngClass]="{'is-invalid' : form.get('applicabilityLevel').status == 'INVALID'}"
                          formControlName="applicabilityLevel">
                          <option selected value=''>Select </option>
                          <option *ngFor="let applicabilityLevel of aplicabilityLevelList" [value]="applicabilityLevel">
                            {{applicabilityLevel}}
                          </option>

                        </select>
                      </div>

                      <div class="col-sm-3">
                        <label class="form-label">Type Of Office</label>
                        <select name="typeOfOffice" id="typeOfOffice" class="form-control"
                          [ngClass]="{'is-invalid' : form.get('typeOfOffice').status == 'INVALID'}"
                          formControlName="typeOfOffice">
                          <option selected value=''>Select </option>
                          <option *ngFor="let typeOfOffice of typeOfOfficeList" [value]="typeOfOffice">
                            {{typeOfOffice}}
                          </option>

                        </select>
                      </div>

                      <div class="col-md-3 mt-20">
                        <label class="custom-control custom-checkbox custom-control-inline pl-45">
                          <input formControlName="institutionActive" autocomplete="off" type="checkbox"
                            class="custom-control-input" name="example-inline-checkbox1" value="option1" checked
                            (change)="deactiveActiveCheckBox()" >
                          <span class="custom-control-label">Active </span>
                        </label>
                      </div>

                      <div class="col-md-3" *ngIf="hideRemark">
                        <label class="form-label">Remark</label>
                        <textarea formControlName="remark" autocomplete="off" class="form-control" rows="2"
                          [ngClass]="{'is-invalid' : form.get('remark').status == 'INVALID'}"
                          placeholder="Enter Remark"></textarea>
                      </div>


                    </div>

                  </fieldset>


                  <div class="row mt-10">
                    <div class="col-md-12">

                      <fieldset>
                        <legend>Address Details</legend>



                        <div class="col-12">

                          <div class="row">
                            <div class="col-sm-3">
                              <label class="form-label"> Address 1</label>
                              <input type="text" formControlName="address1" class="form-control " name="address1"
                                autocomplete="off" [ngClass]="{'is-invalid' : form.get('address1').status == 'INVALID'}"
                                placeholder="Enter Address 1">
                            </div>

                            <div class="col-sm-3">
                              <label class="form-label"> Address 2</label>
                              <input type="text" formControlName="address2" class="form-control " name="address2"
                                autocomplete="off" placeholder="Enter Address 2">
                            </div>

                            <div class="col-sm-3">
                              <label class="form-label"> Address 3</label>
                              <input type="text" formControlName="address3" class="form-control " name="address3"
                                autocomplete="off" placeholder="Enter Address 3">
                            </div>

                            <div class="col-sm-3">
                              <label class="form-label">Country</label>
                              <select name="country" id="country" class="form-control"
                                (change)='onSelectCountry($event.target.value)'
                                [ngClass]="{'is-invalid' : form.get('country').status == 'INVALID'}"
                                formControlName="country">
                                <option selected value=''>Select </option>
                                <option *ngFor="let country of countries" [value]="country">
                                  {{country}}
                                </option>
                              </select>
                            </div>


                          </div> <!-- end of row -->


                          <div class="row mt-20">



                            <div class="col-sm-3">
                              <label class="form-label">PIN</label>
                              <input type="text" class="form-control" placeholder="Enter PIN" minlength="1"
                                (keypress)="keyPress($event)" autocomplete="off" maxlength="6" formControlName="pinCode"
                                pattern="[0-9]{6}" [ngClass]="{'is-invalid' : form.get('pinCode').status == 'INVALID'}"
                                (keyup)="checkLocalAddress(); getPermanentAddressFromPIN();">
                            </div>

                            <div class="col-sm-3">
                              <label class="form-label">State</label>
                              <input type="text" formControlName="state" class="form-control " name="state"
                                autocomplete="off" placeholder="Enter state">
                            </div>

                            <div class="col-sm-3">
                              <label class="form-label">City</label>
                              <input type="text" formControlName="city" class="form-control " name="city"
                                autocomplete="off" placeholder="Enter City">
                            </div>


                            <div class="col-sm-3">
                              <label class="form-label">Village</label>
                              <input type="text" formControlName="village" class="form-control " name="village"
                                autocomplete="off" placeholder="Enter Village">
                            </div>

                          </div>

                          <div class="row mt-20">
                            <div class="col-6">
                              <div class="row">
                                <div class="col-sm-3 col-md-5 country-code  pr-0">

                                  
                                  <label class="form-label">ISD Code</label>
                                  <select class="form-control selectpicker selectpicker"
                                    formControlName="officialCountryCode"
                                    [ngClass]="{'is-invalid' : form.get('officialCountryCode').status == 'INVALID'}">
                                    <!-- <option value='' data-hidden="true">Select</option> -->
                                    <option selected value=''>Select</option>
                                    <option *ngFor="let code of countryCode" [value]="code">
                                      {{code}}
                                    </option>
                                  </select>
                                
                                </div> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <div class="col-sm-3 col-md-6">
                                  <label class="form-label">Tel No.</label>
                                  <input type="text" class="form-control" placeholder="Enter Mobile No." maxlength="10"
                                    autocomplete="off" formControlName="telephoneNumber"
                                    pattern="^[1-9a-zA-Z][0-9a-zA-Z]*$"
                                    [ngClass]="{'is-invalid' : form.get('telephoneNumber').status == 'INVALID'}"
                                    (keypress)="keyPress($event)">


                                </div>
                              </div>

                            </div>
                            <!-- <div class="row">
                          <div class="col-sm-3 col-md-5 country-code  pr-0">
                              <label></label>
                              <select class="form-control selectpicker" placeholder="Select ISD" formControlName="officialCountryCode">
                              <option value='' data-hidden="true">Select</option>
                              <option *ngFor="let code of countryCode"
                                  [value]="code">
                                  {{code}}
                              </option>
                          </select>
                          </div>
                          <div class="col-sm-3 col-md-7 col-lg-6">
                              <label class="form-label">Tel No.</label>
                              <input type="text" class="form-control" placeholder="Enter Mobile No." minlength="1" maxlength="10" formControlName="telephoneNumber">
                          </div>
                        </div> -->




                            <div class="col-sm-3">
                              <label class="form-label">Email Id</label>
                              <input type="text" formControlName="emailId" class="form-control " name="emailId"
                                [ngClass]="{'is-invalid' : form.get('emailId').status == 'INVALID'}"
                                placeholder="Enter Email Id">
                            </div>










                            <!-- <div class="col-sm-3 col-md-6">
                          <label
                              class="form-label"></label>
                          <div class="row">
                              <div class="col-sm-3 col-md-5 country-code">
                                <select class="form-control selectpicker" placeholder="Select ISD"
                                    formControlName="officialCountryCode">
                                    <option value='' data-hidden="true">Select</option>
                                    <option *ngFor="let code of countryCode"
                                        [value]="code">
                                        {{code}}
                                    </option>
                                </select>
                            </div>
                              <div class="col-sm-3 col-md-7">
                                <label
                                class="form-label" style="margin-top: -20%;" >Tel No.</label>
                                  <input type="text" class="form-control"
                                      placeholder="Enter Telephone Number ." minlength="1"
                                      maxlength="10"
                                      formControlName="telephoneNumber">
                              </div>
                          </div>
                      </div> -->










                          </div>
                        </div>
                      </fieldset>
                    </div>
                  </div>



                  <!--end of row-->







                  <div class="col-12 mt-20">

                    <div class="float-right mb-15">
                      <ng-container *ngIf="showButtonSaveAndReset">

                        <ng-container *ngIf="isSaveAndReset; else newDeb">

                          <button type="submit" [disabled]="form.invalid"
                            class="custom_button custom_btn btn-labeled btn-labeled-left" tooltip="Save"
                            (click)="save()"
                            [ngClass]="{'disabled-btn-bg-green' : form.invalid, 'btn-bg-green': !form.invalid}">
                            <b><i class="fa fa-floppy-o"></i></b> Save</button>

                          <button type="button" tooltip="Reset" (click)="cancelView()"  
                            class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left ml-10">
                            <b><i class="fa  fa-refresh"></i></b> Reset</button>
                        </ng-container>


                        <ng-template #newDeb>

                          <!-- <button type="submit"
                            [ngClass]="{'disabled-btn-bg-lightgrey' : form.invalid, 'btn-bg-green': !form.invalid}"
                            class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="Update"
                            (click)="save()" [disabled]="form.invalid">
                            <b><i class="fa fa-floppy-o"></i></b>Update</button> -->
                          <button type="submit"
                            [ngClass]="form.invalid ? 'disabled-button' + ' btn-bg-green': 'btn-bg-green'"
                            class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="Update"
                            (click)="save()" [disabled]="form.invalid">
                            <b><i class="fa fa-floppy-o"></i></b>Update</button>


                          <button type="button"
                            class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left ml-10"
                            tooltip="Cancel" (click)="cancelView()">
                            <b><i class="fa fa-times-circle"></i></b>Cancel</button>
                        </ng-template>
                      </ng-container>

                      <ng-container *ngIf="!showButtonSaveAndReset">
                        <button type="button"
                          class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left ml-10"
                          tooltip="Cancel" (click)="cancelView()">
                          <b><i class="fa fa-times-circle"></i></b>Cancel</button>
                      </ng-container>

                    </div>
                  </div> <!-- <end of div col-6 -->
                </div> <!-- card body -->
              </div>
            </div>
          </div>





          <!-- <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="mb-0">
                  <h3 class="font-14 text-purple font-bold">Summary</h3>
                </div>
                <div class="table-responsive Custom_Table">
                  <table class="table table-striped table-hover table-bordered m-b-0">
                    <thead class="thead-dark">
                      <tr>
                        <th scope="col" class="wd-15">Sr. No.</th>
                        <th scope="col" class="wd-25"> Code</th>
                        <th scope="col" class="wd-25">Country</th>
                        <th scope="col" class="wd-25">Head Name</th>
                        <th scope="col" class="wd-25">Type Of Office</th>
                        <th scope="col" class="wd-25">State</th>

                        <th scope="col" class="wd-25"> Add1</th>
                        <th scope="col" class="wd-25">City</th>
                        <th scope="col" class="wd-25">Remark</th>
                        <th scope="col" class="wd-10">Action</th>
                      </tr>
                    </thead>
                    <tbody>

                      <tr *ngFor="let summary of summaryHtmlDataList; let i = index">
                        <td class="wd-10"><span tooltip="{{summary.SrNo}}">{{summary.SrNo}}</span>
                        </td>
                        <td class="wd-10"><span
                            tooltip=" {{summary.institutionCode}}">{{summary.institutionCode}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.country}}">{{summary.country}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.headNameFull}}">{{summary.headNameShorten}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.typeOfOffice}}">{{summary.typeOfOffice}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.state}} ">{{summary.state}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.address1}} ">{{summary.address1}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.city}}">{{summary.city}}</span>
                        </td>
                        <td class="wd-10"><span tooltip="{{summary.remark}}">{{summary.remark}}</span>
                        </td>

                        <td class="wd-10">

                          <span>
                            <i class="fa fa-edit font-16 text-dark-green cursor-pointer"
                              (click)="editMaster(i,summary.complianceInstitutionMasterId)" tooltip="Edit"></i>
                          </span>

                          <i class="fa fa-eye font-16 text-blue cursor-pointer ml-3" (click)="viewMaster(i)"
                            tooltip="View"></i>
                        </td>
                      </tr>
                      <tr *ngIf="!summaryHtmlDataList?.length">
                        <td colspan="10">
                          <span class="font-14 font500 align-center text-red">No Data Available</span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div> -->

          <br>
          <div class="row mb-0">
            <div class="col-md-12">

              <span class="font-14 text-purple font-bold">Summary</span>

              <div class="justify-content-end p-d-inline-flex float-right">
                <div class="input-icon mb-3">
                  <span class="p-input-icon-left p-ml-auto">
                    <i class="pi pi-search" style="top: 9px !important"></i>
                    <input pInputText type="text"
                      (input)="
                      dt.filterGlobal(
                          $event.target.value,
                          'contains'
                        )
                      "
                      placeholder="Search keyword"
                    />
                  </span>
                </div>

                &nbsp;
                <i class="fa fa-file-excel-o  font-28 text-dark-green cursor-pointer"
                  tooltip="Export To Excel" (click)="exportAsXLSX()"></i>

              </div>
            </div>
           </div>

          <div class="row">
            <div class="col-12 ">
              <div class="card">
                  <p-table #dt [value]="summaryHtmlDataList" [paginator]="true" [rows]="10"
                  [showCurrentPageReport]="true"
                  (sortFunction)="customSort($event)"
                   [customSort]="true"
                    [pageLinks]="5" 
                   currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                   totalRecords={{summaryHtmlDataList.length}} 
                   [rowsPerPageOptions]="[10,25,50,100,200]"
                   
                   [globalFilterFields]="['institutionCode', 'country',  'headNameShorten',
                   'typeOfOffice','state','address1','city','remark']">

                     <ng-template pTemplate="header">
                       <tr>
                         <th class=" text-center">
                          Sr. No.
                           
                         </th>
                        

                       <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">Code
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="institutionCode" pSortableColumn="institutionCode"></p-sortIcon>
                              <p-columnFilter field="institutionCode" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">Country
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="country" pSortableColumn="country"></p-sortIcon>
                              <p-columnFilter field="country" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>
                         <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">Head Name
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="headNameShorten" pSortableColumn="headNameShorten"></p-sortIcon>
                              <p-columnFilter field="headNameShorten" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">Type Of Office
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="typeOfOffice" pSortableColumn="typeOfOffice"></p-sortIcon>
                              <p-columnFilter field="typeOfOffice" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">State
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="state" pSortableColumn="state"></p-sortIcon>
                              <p-columnFilter field="state" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">Address
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="address1" pSortableColumn="address1"></p-sortIcon>
                              <p-columnFilter field="address1" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">City
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="city" pSortableColumn="city"></p-sortIcon>
                              <p-columnFilter field="city" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center">
                          <div class="p-d-flex  justify-content-center p-ai-center">Remark
                            <div class="Sort_Filter_Position">
                              <p-sortIcon field="remark" pSortableColumn="remark"></p-sortIcon>
                              <p-columnFilter field="remark" display="menu" class="p-ml-auto">
                              </p-columnFilter>
                            </div>
                          </div>
                        </th>

                        <th class="text-center wd-8">
                          Action
                        </th>        
                       </tr>
                     </ng-template>
                     <ng-template pTemplate="body" let-summary  let-rowIndex="rowIndex" >
                      <tr class="p-selectable-row">
                          <td class="text-center">{{rowIndex + 1}}</td>
                          <td>
                              <label
                                  class="form-lable mb-0">
                                  {{summary.institutionCode}}</label>
                          </td>
                          <td>
                              <label
                                  class="form-lable mb-0 ">{{summary.country}}</label>
                          </td>

                          <td> <label
                                  class="form-lable mb-0 ">{{summary.headNameShorten}}</label>
                                  </td>
                                  <td> <label
                                    class="form-lable mb-0 ">{{summary.typeOfOffice}}</label>
                                    </td>
                                    <td> <label
                                      class="form-lable mb-0 ">{{summary.state}}</label>
                                      </td>
                                      <td> <label
                                        class="form-lable mb-0 ">{{summary.address1}}</label>
                                        </td>
                                        <td> <label
                                        class="form-lable mb-0 ">{{summary.city}}</label>
                                        </td>
                                        <td> <label
                                          class="form-lable mb-0 ">{{summary.remark}}</label>
                                          </td>

                                          <td class="text-center">

                                            <span>
                                              <i class="fa fa-edit font-16 text-dark-green cursor-pointer"
                                                (click)="editMaster(rowIndex,summary.complianceInstitutionMasterId)" tooltip="Edit"></i>
                                            </span>
                  
                                            <i class="fa fa-eye font-16 text-blue cursor-pointer ml-3" (click)="viewMaster(rowIndex)"
                                              tooltip="View"></i>
                                          </td>

                      </tr>
                  </ng-template>

                     <ng-template pTemplate="emptymessage">
                       <tr>
                         <td colspan="15" class="font-14 font500 text-center text-red"><span>No Data
                             Available</span>
                         </td>
                       </tr>
                     </ng-template>
                   </p-table>
</div>
</div>
</div>


        </div>
      </div>
      <app-footer></app-footer>
    </div>
  </div>
</form>
