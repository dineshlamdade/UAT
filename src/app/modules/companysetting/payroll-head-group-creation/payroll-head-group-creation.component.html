<app-leftmenu></app-leftmenu>
<!-- Main body part  -->
<div class="page">
  <app-header></app-header>
  <div class="section-body mt-3">
    <div class="container-fluid">
      <div class="row clearfix">
        <div class="col-12">
          <div class="card">
            <div class="card-body">
              <form class="card" role="form" [formGroup]="payrollHeadGroupCreationForm" method="post" novalidate>

                <div class="row">

                  <div class="col-sm-6 col-md-3">
                    <label class="form-label">Name</label>
                    <div class="input-group">
                      <input type="text" (change)="onChangeHeadGroupDefinitionName($event); isContainsOnlySpecialCharacterDescription();" onkeypress="return /[0-9a-zA-Z_-]/i.test(event.key)" [maxlength]="25"
                        formControlName="headGroupDefinitionName" class="form-control" placeholder="Enter Name"
                        [ngClass]="{'is-invalid' : payrollHeadGroupCreationForm.get('headGroupDefinitionName').status == 'INVALID' || codeInvalid == true}">
                    </div>
                  </div>

                  <div class="col-sm-6 col-md-3">
                    <label class="form-label">Description</label>
                    <div class="input-group">
                      <input type="text" formControlName="description" class="form-control" onkeypress="return /[0-9a-zA-Z%/_ ]/i.test(event.key)" [maxlength]="50"
                        placeholder="Enter Description"
                        [ngClass]="{'is-invalid' : payrollHeadGroupCreationForm.get('description').status == 'INVALID'}">
                    </div>
                  </div>


                  <div class="col-sm-6 col-md-3" [ngClass]="[disabled ? 'searchclosebutton2' : 'disableDiv']">
                    <label class="form-label">Attribute Group</label>
                    <select (change)="onChangeAttributeGroupDropDown($event);"
                      [ngClass]="{'is-invalid' : payrollHeadGroupCreationForm.get('attributeNature').status == 'INVALID'}"
                      name="attributeGroupList" id="attributeGroupList" class="form-control  "
                      formControlName="attributeNature">
                      <option selected value=''>Select </option>
                      <option *ngFor="let by of attributeGroupList" [value]="by.name">
                        {{by.name}}
                      </option>
                    </select>
                  </div>
                  <br><br><br>
                </div>
              </form>

              <!-- First POP-UP  -->
              <ng-template #template1244>
                <div class="modal-header">
                  <h5 class="modal-title" id="UploadModalLabel">Payroll Head Group
                  </h5>
                  <button type="button" (click)="modalRef1.hide()" class="close" (click)="onCloseTemplate1244()"
                    data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="modal-body">
                  <div class="card">
                    <div class="card-body">
                      <div class="row">
                        <div class="col-md-12 pl-0 pr-0">
                          <div class="bg-color-light_gray pt-10 pl-10 pr-10">


                            <div class="row">

                              <div class="col-sm-6 col-md-4">
                                <label class="form-label">Payroll Head Group Name</label>
                                <label class="form-label  font500"> {{beforeSavePHGName1}} </label>
                              </div>

                              <div class="col-sm-6 col-md-4">
                                <label class="form-label">Attribute Group </label>
                                <label class="form-label font500"> {{AttGrpName}} </label>
                              </div>


                              <div class="col-sm-3 col-md-3"
                                [ngClass]="[disabled ? 'searchclosebutton2' : 'disableDiv']" *ngIf="!hideCopyFrom">
                                <label class="form-label">Copy From</label>
                                <select (change)="onChangeCopyFromPHG_Name($event.target.value);"
                                  class="form-control  ">
                                  <option selected value=''>Select </option>
                                  <option *ngFor="let by of PayrollHeadGroupList" [value]="by.headGroupDefinitionName">
                                    {{by.headGroupDefinitionName}}
                                  </option>
                                </select>
                              </div>

                            </div>
                          </div>
                        </div>
                      </div>


                      <!-- </form> -->




                      <!-- <div class="row mt-5"> -->
                      <div class="row">
                        <div class="col-md-5">

                          <div class="cycle-table mt-10">

                            <div class="row">
                              <div class="col-md-6">
                                <span class="form-label font-14 text-purple font-bold">Total Head:
                                  <span class="font-14 text-dark-green">({{sourceProducts.length}})</span>
                                </span>
                              </div>
                              <div class="col-md-6">
                                <div class="float-right">
                                  <span class=" form-label font-14 text-purple font-bold"> &nbsp;&nbsp; Selected Head:
                                    &nbsp;
                                    <span class="font-14 text-dark-green">({{selectedUser.length}})</span>
                                  </span>
                                </div>
                              </div>
                            </div>



                           <!-- <h3 class="font-14 text-purple font-bold"><span class="form-label"> Total Head:
                                  <span class="font-14 text-dark-green"> ({{sourceProducts.length}})</span>
                                  &nbsp;&nbsp;&nbsp;<span class="font-14  text-purple font-bold float-right">Selected
                                    Head:
                                    ({{selectedUser.length}})</span> </span></h3> -->

                            <!-- <p-table [value]="sourceProducts" [paginator]="true" [rows]="10"
                              [showCurrentPageReport]="true" selectionMode="multiple"
                              [(selection)]="selectedSummarySourceProducts"
                              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                              [rowsPerPageOptions]="[10,25,50,100,200]"> -->

                              <p-table [value]="sourceProducts" [paginator]="true" [rows]="10"
                              [showCurrentPageReport]="true" [pageLinks]="5" (onPage)="paginate($event)"
                              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                              totalRecords={{sourceProducts.length}} [rowsPerPageOptions]="[10,25,50,100,200]">


                              <ng-template pTemplate="header">
                                <tr>

                                  <th rowspan="1" class="wd-15">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Code
                                      <div class="Sort_Filter_Position">
                                        <p-sortIcon field="standardName" pSortableColumn="standardName">
                                        </p-sortIcon>
                                        <p-columnFilter field="standardName" display="menu" class="p-ml-auto">
                                        </p-columnFilter>
                                      </div>
                                    </div>
                                  </th>

                                  <th rowspan="1" class="wd-15">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Description
                                      <div class="Sort_Filter_Position">
                                        <p-sortIcon field="description" pSortableColumn="description">
                                        </p-sortIcon>
                                        <p-columnFilter field="description" display="menu" class="p-ml-auto">
                                        </p-columnFilter>

                                      </div>
                                    </div>
                                  </th>
                                  <th rowspan="1" class="wd-8">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Nature
                                      <div class="Sort_Filter_Position">
                                        <p-sortIcon field="headNature" pSortableColumn="headNature"></p-sortIcon>
                                        <p-columnFilter field="headNature" display="menu" class="p-ml-auto">
                                        </p-columnFilter>

                                      </div>
                                    </div>
                                  </th>
                                </tr>
                              </ng-template>

                              <ng-template pTemplate="body" let-user1 let-rowIndex="rowIndex">
                                <tr (click)="RowSelected(user1, rowIndex);" [class.active]="user1.isHighlight"
                                  (dblclick)="doubleClickOnLeftTable(user1)"
                                  [ngClass]="{'outofstock':user1.isHighlight == true}">
                                  <td>{{user1.standardName}} </td>
                                  <td>{{user1.description}} </td>
                                  <td>{{user1.headNature}} </td>
                                </tr>

                              </ng-template>
                              <ng-template pTemplate="emptymessage">
                                <tr>
                                  <td colspan="15" class="font-14 font500 text-center text-red"><span>No Data
                                      Available</span></td>
                                </tr>
                              </ng-template>
                            </p-table>
                          </div>
                        </div>


                        <div class="col-1">
                          <div class="row mt-150">
                            <div class="col-md-12 mt-10 text-center">
                              <button type="button" class="btn btn-sm bg-teal-400" (click)="lefttablePusg()">
                                <i class="fa fa-chevron-right"></i></button>
                            </div>
                            <div class="col-md-12 mt-10 text-center">
                              <button type="button" class="btn btn-sm bg-teal-400" (click)="righttablePusg()">
                                <i class="fa fa-chevron-left"></i>
                              </button>
                            </div>
                          </div>
                        </div>



                        <div class="col-md-5">
                          <div class="cycle-table mt-10">
                            <div class="row">
                              <div class="col-md-6">
                                <span class="form-label font-14 text-purple font-bold">Total Head:
                                  <span class="font-14 text-dark-green">({{targetProducts.length}})</span>
                                </span>
                              </div>
                              <div class="col-md-6">
                                <div class="float-right">
                                  <span class=" form-label font-14 text-purple font-bold"> &nbsp;&nbsp;Selected
                                    Head: &nbsp;
                                    <span class="font-14 text-dark-green">({{selectedUser2.length}})</span>
                                  </span>
                                </div>
                              </div>
                            </div>
                             <!-- <h3 class="font-14 text-purple font-bold">
                                  <span class="form-label">Total Head:
                                    <span class="font-14 text-dark-green">({{targetProducts.length}})</span>
                                  </span>
                                  <span class=" form-label float-right"> &nbsp;&nbsp;Selected
                                    Head: &nbsp;
                                    <span class="font-14 text-dark-green">({{selectedUser2.length}})</span>
                                  </span>

                                </h3> -->
<!--
                            <p-table [value]="targetProducts" [paginator]="true" [rows]="10"
                              [showCurrentPageReport]="true" selectionMode="multiple"
                              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                              [rowsPerPageOptions]="[10,20,50,100,200]"> -->

                              <p-table [value]="targetProducts" [paginator]="true" [rows]="10"
                              [showCurrentPageReport]="true" [pageLinks]="5" (onPage)="paginate($event)"
                              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                              totalRecords={{targetProducts.length}} [rowsPerPageOptions]="[10,25,50,100,200]">



                              <ng-template pTemplate="header">
                                <tr>

                                  <th rowspan="1" class="wd-15">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Code
                                      <div class="Sort_Filter_Position">
                                        <p-sortIcon field="standardName" pSortableColumn="standardName">
                                        </p-sortIcon>
                                        <p-columnFilter field="standardName" display="menu" class="p-ml-auto">
                                        </p-columnFilter>
                                      </div>
                                    </div>
                                  </th>

                                  <th rowspan="1" class="wd-15">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Description
                                      <div class="Sort_Filter_Position">
                                        <p-sortIcon field="description" pSortableColumn="description">
                                        </p-sortIcon>
                                        <p-columnFilter field="description" display="menu" class="p-ml-auto">
                                        </p-columnFilter>

                                      </div>
                                    </div>
                                  </th>
                                  <th rowspan="1" class="wd-8">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Nature
                                      <div class="Sort_Filter_Position">
                                        <p-sortIcon field="headNature" pSortableColumn="headNature">
                                        </p-sortIcon>
                                        <p-columnFilter field="headNature" display="menu" class="p-ml-auto">
                                        </p-columnFilter>

                                      </div>
                                    </div>
                                  </th>
                                  <th rowspan="1" class="wd-8" *ngIf="hideCopyFrom">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                      Attribute Assign Status

                                    </div>
                                  </th>
                                </tr>
                              </ng-template>

                              <ng-template pTemplate="body" let-user1 let-rowIndex="rowIndex">
                                <tr (click)="RowSelectedtargetProducts(user1, rowIndex);"
                                  (dblclick)="doubleClickOnRightTable(user1)"
                                  [ngClass]="{'outofstock':user1.isHighlightright == true}">

                                  <td>{{user1.standardName}}</td>
                                  <td>{{user1.description}}</td>
                                  <td>{{user1.headNature}} </td>
                                  <td class="wd-10 align-center" *ngIf="hideCopyFrom">
                                    <span *ngIf="user1.red  == true"><i class="fa fa-circle-o fa-lg" aria-hidden="true"
                                        (click)="onSelectAttributeAssignment(user1);UploadModal2(template12445);modalRef1.hide()"
                                        data-toggle="modal" data-backdrop='static' data-keyboard='false'
                                        data-target="#UploadModal"></i></span>

                                    <span *ngIf="user1.green == true"><i class="fa fa-circle  fa-lg" aria-hidden="true"
                                        (click)="onSelectAttributeAssignment(user1);UploadModal2(template12445);modalRef1.hide()"
                                        data-toggle="modal" data-backdrop='static' data-keyboard='false'
                                        data-target="#UploadModal"></i></span>

                                    <span *ngIf="user1.blue ==true"><i class="fa fa-adjust fa-lg" aria-hidden="true"
                                        (click)="onSelectAttributeAssignment(user1);UploadModal2(template12445);modalRef1.hide()"
                                        data-toggle="modal" data-backdrop='static' data-keyboard='false'
                                        data-target="#UploadModal"></i></span>
                                  </td>
                                </tr>
                              </ng-template>
                              <ng-template pTemplate="emptymessage">
                                <tr>
                                  <td colspan="15" class="font-14 font500 text-center text-red"><span>No Data
                                      Available</span></td>
                                </tr>
                              </ng-template>
                            </p-table>
                          </div>
                        </div>
                      </div>





                      <!-- </div> -->


                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" *ngIf="!viewupdateButton" class="btn btn-primary" onClick="this.disabled=true;"
                    (click)=" addPayrollHeadGroup()">Save</button>

                  <button type="button" *ngIf="viewupdateButton" (click)="addPayrollHeadGroup()"
                    onClick="this.disabled=true;"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="Update"><b><i
                        class="fa fa-floppy-o"></i></b>
                    Update</button>
                </div>
              </ng-template>

              <!-- Second POP up -->
              <ng-template #template12445>
                <div class="modal-header">
                  <h5 class="modal-title" id="UploadModalLabel">Payroll Head Group
                  </h5>
                  <button type="button" (click)="modalRef.hide()" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>

                <div class="modal-body">
                  <div class="card">
                    <div class="card-body p-0">
                      <div class="row">
                        <div class="col-md-12 pl-0 pr-0">
                          <div class="bg-color-light_gray pt-10 pl-10 pr-10">

                            <div class="row">
                              <div class="col-sm-6 col-md-4">
                                <label class="form-label">Head Name</label>
                                <label> <span class="form-label font500">{{HeadName}} &nbsp;</span>
                                  <!-- {{selectedHeadGroupIds}} -->
                                </label>
                              </div>

                              <div class="col-sm-6 col-md-4">
                                <label class="form-label">Nature </label>
                                <label> <span class="form-label font500">{{Nature}}</span> </label>
                              </div>

                              <div class="col-sm-6 col-md-4">
                                <label class="form-label">Payroll Head Group Name </label>
                                <label class="form-label  font500"> {{beforeSavePHGName1}} </label>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-6 col-md-4" [ngClass]="[disabled ? 'searchclosebutton2' : 'disableDiv']"
                        *ngIf="viewSaveButton">
                        <label class="form-label">Copy From</label>
                        <select (change)="copyFrommPayrollHeadGroup($event);" class="form-control">
                          <option selected value=''>Select </option>
                          <option *ngFor="let by of savedHeadNameList" [value]="by.headGroupIds">
                            {{by.standardName}}
                          </option>
                        </select>
                      </div>


                      <form class="card" role="form" [formGroup]="form" #formDirective="ngForm" method="post"
                        novalidate>

                        <div class="row mt-10">
                          <div class="col-md-12">
                            <div class="card">
                              <div class="">
                                <div class="table-responsive Custom_Table">
                                  <table class="table table-striped table-hover table-bordered m-b-0"
                                    style="width:130%">
                                    <thead class="thead-dark">
                                      <tr>
                                        <!-- <th scope="col" class="font700 wd-15">Attribute</th>
                                        <th scope="col" class="font700 wd-15"> Nature</th>

                                        <th scope="col" class="font700 wd-10">Applicable</th>
                                        <th scope="col" class="font700 wd-12">Value</th>
                                        <th scope="col" class="font700 wd-12">From Date</th>
                                        <th scope="col" class="font700 wd-12">To Date</th>
                                        <th scope="col" class="font700 wd-10">Range From</th>
                                        <th scope="col" class="font700 wd-10">Range To</th>
                                        <th scope="col" class="font700 wd-12">Once Every</th>
                                        <th scope="col" class="font700 wd-10">Frequency</th>
                                        <th scope="col" class="font700 wd-6">Action</th> -->
                                        <th class="font700 wd-10">Attribute</th>
                                        <th class="font700 wd-15"> Nature</th>
                                        <th class="font700 wd-8">Applicable</th>
                                        <th class="font700 wd-10">Value</th>
                                        <th class="font700 wd-14">From Date</th>
                                        <th class="font700 wd-11">To Date</th>
                                        <th class="font700 wd-8">Range From</th>
                                        <th class="font700 wd-8">Range To</th>
                                        <th class="font700 wd-8">Once Every</th>
                                        <th class="font700 wd-20">Frequency</th>
                                        <th class="font700 wd-6">Action</th>
                                      </tr>
                                    </thead>
                                    <tbody formArrayName="pfFormArray">




                                      <tr *ngFor="let summary of pfArray.controls;let i = index; " [formGroupName]="i">

                                        <td class="wd-10 bg-color-light_gray align-left">
                                          <span tooltip="{{pfArray['controls'][i].get('attributeNature').value}}">


                                            <label class="form-lable mb-0 text-link align-left"
                                              (click)="openNewPopUpWindow(template1244511, selectedHeadGroupIds, pfArray['controls'][i].get('attributeGroupIds').value )">{{pfArray['controls'][i].get('code').value}}
                                            </label></span>
                                        </td>

                                        <td class="wd-10 bg-color-light_gray align-left"
                                          tooltip="{{pfArray['controls'][i].get('attributeMasterId').value}}">
                                          {{pfArray['controls'][i].get('attributeNature').value}}
                                        </td>

                                        <td>

                                          <select class="form-control" formControlName="Applicability"
                                            (change)="onChangeApplicability($event.target.value,i)">

                                            <option *ngFor="let by of applicableList" [value]="by.id">
                                              {{by.itemName}}
                                            </option>
                                          </select>
                                        </td>


                                        <td
                                          *ngIf="pfArray['controls'][i].get('attributeNature').value.trim()=='Formula'">
                                          <select class="form-control" formControlName="value"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value').status == 'INVALID'}">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of FormulaArray" [value]="by.formulaName">
                                              {{by.formulaName}}
                                            </option>
                                          </select>
                                        </td>

                                        <td
                                          *ngIf="pfArray['controls'][i].get('attributeNature').value.trim()=='Source Destination Matrix'">
                                          <select class="form-control " formControlName="value"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value').status == 'INVALID'}">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of SDMArray" [value]="by.sdmSchemaName">
                                              {{by.sdmSchemaName}}
                                            </option>
                                          </select>
                                        </td>

                                        <td *ngIf="pfArray['controls'][i].get('attributeNature').value.trim()=='Head'">
                                          <select class="form-control " formControlName="value"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value').status == 'INVALID'}">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of allGlobalHeadList" [value]="by.standardName">
                                              {{by.standardName}}
                                            </option>
                                          </select>
                                        </td>

                                        <td
                                          *ngIf="pfArray['controls'][i].get('attributeNature').value.trim()=='Per Employee Input'">
                                          <input type="text" class="form-control" disabled="true" [readonly]="true">
                                        </td>


                                        <td
                                          *ngIf="pfArray['controls'][i].get('attributeNature').value.trim()=='Range Value No Of Instances Per Period' || pfArray['controls'][i].get('attributeNature').value.trim()=='Range Value Per Period' ||  pfArray['controls'][i].get('attributeNature').value.trim()=='Range Value Per Instance'">
                                          <input type="text" class="form-control" disabled="true" [readonly]="true">
                                        </td>

                                        <td *ngIf="pfArray['controls'][i].get('attributeNature').value.trim()=='List'">
                                          <select class="form-control  " formControlName="value"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value').status == 'INVALID'}">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of pfArray['controls'][i].get('options').value"
                                              [value]="by.attributeOptionValue">
                                              {{by.attributeOptionValue}}
                                            </option>
                                          </select>
                                        </td>

                                        <td class="   p-d-inline-flex">
                                          <!-- ml-2 mr-2 mt-2  *ngIf="pfArray['controls'][i].get('code').value.length!==0"-->
                                          <span
                                            (click)="copyDateFromTableRow(i,pfArray['controls'][i].get('fromDate').value,pfArray['controls'][i].get('toDate').value, pfArray['controls'][i].get('Applicability').value)"><i
                                              class="fa fa-clone text-blue font-16 mr-2 mt-2"></i></span>


                                          <input [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                                            formControlName="fromDate" data-provide="datepicker"
                                            (bsValueChange)="onChangeFromDate($event,i)"
                                            (focusout)="onChangeFromDate($event,i)" data-date-autoclose="true"
                                            class="form-control" placement="center" placeholder="From Date"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('fromDate').status == 'INVALID'}"
                                            bsDatepicker>
                                        </td>


                                        <td>
                                          <input [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                                            formControlName="toDate" data-provide="datepicker"
                                            data-date-autoclose="true" class="form-control" placement="center"
                                            (bsValueChange)="onChangeToDate($event,i)"
                                            [minDate]="pfArray['controls'][i].get('minDate1').value"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('toDate').status == 'INVALID'}"
                                            placeholder="To Date" bsDatepicker>
                                        </td>
                                        <td>
                                          <input type="text" formControlName="value1" class="form-control"
                                            (focusout)="onChangeRangeFrom($event,i)" placeholder="From"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value1').status == 'INVALID'}">
                                        </td>
                                        <td>
                                          <input type="text" formControlName="value2" class="form-control"
                                            (focusout)="onChangeRangeTo($event,i)" placeholder="To"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value2').status == 'INVALID'}">
                                        </td>
                                        <td>
                                          <input type="text" formControlName="value3" class="form-control"
                                            placeholder="Every"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value3').status == 'INVALID'}">
                                        </td>
                                        <td>
                                          <select class="form-control" formControlName="value4"
                                            (change)="onChangeActiveFrequency($event.target.value,pfArray['controls'][i].get('attributeMasterId1').value,i)"
                                            [ngClass]="{'is-invalid' :pfArray['controls'][i].get('value4').status == 'INVALID'}">

                                            <option
                                              *ngFor="let activeFrequency of pfArray['controls'][i].get('sortedFrequencyList').value"
                                              [value]="activeFrequency.name">
                                              {{activeFrequency.name}}
                                            </option>
                                          </select>
                                        </td>

                                        <td> <span
                                            *ngIf="pfArray['controls'][i].get('attributeNature').value ==='Range Value No Of Instances Per Period' || pfArray['controls'][i].get('attributeNature').value ==='Range Value Per Period'">

                                            <span
                                              *ngIf="  pfArray['controls'][i].get('code').value.length!=0 &&  pfArray['controls'][i].get('isPlusSignVisible').value ==true">
                                              <i style="font-size: 12;" class="fa fa-plus-circle font-12 cursor-pointer"
                                                tooltip="Add Row"
                                                (click)="addRow(i+1,pfArray['controls'][i].get('attributeMasterId1').value)"></i>
                                              <i tooltip="Add Row"
                                                (click)="addRow(i+1,pfArray['controls'][i].get('attributeMasterId1').value)">&nbsp;Add</i></span>&nbsp;&nbsp;&nbsp;&nbsp;

                                            <i style="font-size: 12;"
                                              *ngIf="pfArray['controls'][i].get('code').value.length==0"
                                              class="fa fa-trash-o  font-12 text-red cursor-pointer"
                                              tooltip="Delete Row"
                                              (click)="deleteRowModal(template33,i);">&nbsp;Delete</i>
                                          </span>
                                        </td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <div class="col-sm-6 col-md-4">
                        <label class="form-label">Copy To</label>
                        <ng-multiselect-dropdown [placeholder]="'None Selected'" #multiSelect style="font-size: small;"
                          [settings]="dropdownSettings" [data]="notOrigianlSavedHeadList"
                          (onSelect)="onItemSelect($event)" (onSelectAll)="onSelectAll($event)"
                          (onDeSelectAll)="onDeSelectAll()" [(ngModel)]="multiSelectDropDownData"
                          (onDeSelect)="onItemDeSelect($event)">

                        </ng-multiselect-dropdown>
                      </div>


                    </div>
                  </div>
                </div>




                <div class="modal-footer">

                  <!-- <button type="button" (click)="firstSave()" [disabled]="clickedOnSave"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="Save Test"><b><i
                        class="fa fa-floppy-o"></i></b>
                    Save Test</button> -->

                  <!-- <button type="button" *ngIf="!viewSaveButton" (click)="TestJsonObject1();"
                    onClick="this.disabled=true;"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="Save"><b><i
                        class="fa fa-floppy-o"></i></b>
                    Update</button> -->

                  <button type="button" *ngIf="!viewSaveButton" (click)="firstSave();" [disabled]="clickedOnSave"
                    id="updateButton" [ngClass]="form.invalid ? 'disabled-button' + ' btn-bg-green': 'btn-bg-green'"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="Update"
                    [disabled]="form.invalid">
                    <b><i class="fa fa-floppy-o"></i></b>Update</button>

                  <!-- (click)="SaveNext(selectedHeadGroupIds);" -->
                  <!-- <button type="button" *ngIf="headNameIndex != headNameSize-1"
                    (click)="SaveNext(selectedHeadGroupIds );"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left"
                    tooltip="Save & Next"><b><i class="fa fa-floppy-o"></i></b>
                    Save & Next</button> -->



                  <!-- <button type="button" (click)="TestJsonObject1();" onClick="this.disabled=true;"
                    [ngClass]="{'disabled-btn-bg-green' : !this.disabled, 'btn-bg-green': this.disabled}"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left" tooltip="TEST JSON"><b><i
                        class="fa fa-floppy-o"></i></b>Save
                  </button> -->

                  <button type="button" *ngIf="viewSaveButton" [disabled]="form.invalid" (click)="firstSave();"
                    [disabled]="clickedOnSave" class="custom_button custom_btn btn-labeled btn-labeled-left"
                    tooltip="Save" [ngClass]="{'disabled-btn-bg-green' : form.invalid, 'btn-bg-green': !form.invalid}">
                    <b><i class="fa fa-floppy-o"></i></b> Save</button>


                  <button type="button" *ngIf="headNameIndex !=headNameSize-1" (click)="Next(selectedHeadGroupIds);"
                    class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left ml-10" tooltip="Next"><b><i
                        class="fa fa-angle-double-right"></i></b>
                    Next </button>



                  <!--  -->
                  <!--
                  <button type="button" (click)="checkValidation()" checkValidation *ngIf="headNameIndex>0"
                    [ngClass]="{'disabled-btn-bg-green' : !this.form, 'btn-bg-green': this.form}" class=""
                    tooltip="Previous"><b><i class="fa fa-floppy-o"></i></b>Previous
                  </button> -->

                  <button type="button" *ngIf="headNameIndex>0" (click)="viewPreviousButton(selectedHeadGroupIds);"
                    class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left ml-10"
                    tooltip="Previous"><b><i class="fa fa-angle-double-left"></i></b>
                    Previous</button>






                </div>
              </ng-template>


              <ng-template #template22>
                <div class="modal-header">
                  <h5 class="modal-title" id="UploadModalLabel">Delete
                    Payroll Head Group</h5>
                  <button type="button" (click)="deleteModalRef.hide()" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="modal-body">
                  <div class="card">
                    <div class="card-body">
                      <div class="row clearfix">
                        <div class="col-md-12">
                          <label class="form-label">Are
                            you sure want to
                            delete? </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary"
                    (click)="DeletePayrollHeadGroup();deleteModalRef.hide()">Yes</button>
                  <button type="button" class="btn btn-secondary bg-btn-red" (click)="deleteModalRef.hide()">No</button>
                </div>
              </ng-template>


              <ng-template #template33>
                <div class="modal-header">
                  <h5 class="modal-title" id="UploadModalLabel">Delete
                    Payroll Head Group</h5>
                  <button type="button" (click)="deleteRowModal1.hide()" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="modal-body">
                  <div class="card">
                    <div class="card-body">
                      <div class="row clearfix">
                        <div class="col-md-12">
                          <label class="form-label">Are
                            you sure want to
                            delete? </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary"
                    (click)="deleteRow();deleteRowModal1.hide()">Yes</button>
                  <button type="button" class="btn btn-secondary bg-btn-red"
                    (click)="deleteRowModal1.hide()">No</button>
                </div>
              </ng-template>










              <div class="row mt-15">
                <div class="col-12">
                  <div class="float-right mb-15">
                    <button type="button" (click)="UploadModalYesNo(template1244);" *ngIf="!viewCancelButton && !viewupdateButton"
                      data-toggle="modal" data-target="#UploadModal" [disabled]="payrollHeadGroupCreationForm.invalid"
                      [ngClass]="{'disabled-btn-bg-green' : payrollHeadGroupCreationForm.invalid,'btn-bg-green': !payrollHeadGroupCreationForm.invalid}"
                      class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left"
                      tooltip="Create Payroll Head Group(PHG)"><b><i class="fa fa-floppy-o"></i></b>
                      Create Payroll Head Group(PHG)</button>


                    <button type="button" *ngIf="viewupdateButton" (click)="UploadModalYesNo(template1244);"
                      data-toggle="modal" data-target="#UploadModal"
                      class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left"
                      tooltip="Update Payroll Head Group(PHG)"><b><i class="fa fa-floppy-o"></i></b>
                      Update Payroll Head Group(PHG)</button>


                    <button type="button" (click)="CancelAttributeCreation()" *ngIf="viewCancelButton"
                      class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left ml-10"
                      tooltip="Cancel"><b><i class="fa fa-times" aria-hidden="true"></i></b>
                      Cancel</button>




                    <button type="button" (click)="resetAttributeSelection()" *ngIf="!viewCancelButton"
                      class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left ml-10"
                      tooltip="Reset"><b><i class="fa fa-refresh" aria-hidden="true"></i></b>
                      Reset</button>
                  </div>
                </div>
              </div>





              <ng-template #template1244511>
                <div class="modal-header">
                  <h5 class="modal-title" id="UploadModalLabel">Payroll Head Group
                  </h5>
                  <button type="button" (click)="modalRef2.hide()" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>

                <div class="modal-body">
                  <div class="card">
                    <div class="card-body p-0">

                      <div class="row">
                        <div class="col-md-12 pl-0 pr-0">
                          <div class="bg-color-light_gray pt-10 pl-10 pr-10">
                            <div class="row">
                              <div class="col-md-12 pl-0 pr-0">
                                <div class="bg-color-light_gray pt-10 pl-10 pr-10">

                                  <div class="row">

                                    <div class="col-sm-6 col-md-4">
                                      <label class="form-label">Head Name</label>
                                      <label> <span class="form-label font500">{{HeadName}} &nbsp;
                                        </span>
                                        <!-- {{selectedHeadGroupIds}} for headGroupIds -->
                                      </label>
                                    </div>

                                    <div class="col-sm-6 col-md-4">
                                      <label class="form-label">Nature </label>
                                      <label> <span class="form-label font500">{{Nature}}</span> </label>
                                    </div>

                                    <div class="col-sm-6 col-md-4">
                                      <label class="form-label">Payroll Head Group Name </label>
                                      <label class="form-label  font500"> {{beforeSavePHGName1}} </label>
                                    </div>

                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>




                      <form class="card" role="form" [formGroup]="form" #formDirective="ngForm" method="post"
                        novalidate>

                        <div class="row mt-10">
                          <div class="col-md-12">
                            <div class="card">
                              <div class="">
                                <div class="table-responsive Custom_Table">
                                  <table class="table table-striped table-hover table-bordered m-b-0">
                                    <thead class="thead-dark">
                                      <tr>
                                        <th class="font700 wd-20">Attribute</th>
                                        <th class="font700 wd-20">Applicable</th>
                                        <th class="font700 wd-15">Value</th>
                                        <th class="font700 wd-15">From Date</th>
                                        <th class="font700 wd-10">To Date</th>
                                        <th class="font700 wd-20">Range From</th>
                                        <th class="font700 wd-20">Range To</th>
                                        <th class="font700 wd-20">Once Every</th>
                                        <th class="font700 wd-10">Frequency</th>
                                        <!-- <th   class="font700 wd-6">Action</th> -->
                                      </tr>
                                    </thead>
                                    <tbody formArrayName="pfFormArray1">


                                      <tr *ngFor="let summary of pfArray1.controls;let i = index; " [formGroupName]="i">

                                        <td>
                                          <span
                                            tooltip="{{pfArray1['controls'][i].get('attributeNature').value.trim()}}">
                                            {{pfArray1['controls'][i].get('code').value.trim()}}
                                          </span>
                                        </td>
                                        <td>
                                          <!-- ,pfArray1['
                                          controls'][i].get('attributeNature').value, pfArray1['controls'][i].get('attributeMasterId1').value -->
                                          <select class="form-control" formControlName="Applicability"
                                            (change)="onChangeApplicability($event.target.value,i)">

                                            <option *ngFor="let by of applicableList" [value]="by.id">
                                              {{by.itemName}}
                                            </option>
                                          </select>
                                        </td>

                                        <!-- <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()!='Formula' && pfArray1['controls'][i].get('attributeNature').value.trim()!='List' && pfArray1['controls'][i].get('attributeNature').value.trim()!='input'  && pfArray1['controls'][i].get('attributeNature').value.trim()!=='Source Destination Matrix' && pfArray1['controls'][i].get('attributeNature').value.trim()!='Head' && pfArray1['controls'][i].get('attributeNature').value.trim() !='Per Employee Input' && pfArray1['controls'][i].get('attributeNature').value.trim() !='Range Value Per Period'  ">
                                          <input type="text" formControlName="value" class="form-control"
                                            placeholder="Enter Value">
                                        </td> -->

                                        <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()=='Formula'">
                                          <select class="form-control" formControlName="value">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of FormulaArray" [value]="by.formulaName">
                                              {{by.formulaName}}
                                            </option>
                                          </select>
                                        </td>

                                        <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()=='Source Destination Matrix'">
                                          <select class="form-control " formControlName="value">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of SDMArray" [value]="by.sdmSchemaName">
                                              {{by.sdmSchemaName}}
                                            </option>
                                          </select>
                                        </td>

                                        <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()=='Head'">
                                          <select class="form-control " formControlName="value">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let by of allGlobalHeadList" [value]="by.standardName">
                                              {{by.standardName}}
                                            </option>
                                          </select>
                                        </td>

                                        <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()=='Per Employee Input'">
                                          <input type="text" class="form-control" disabled="true" [readonly]="true">
                                        </td>

                                        <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()=='Range Value No Of Instances Per Period' || pfArray1['controls'][i].get('attributeNature').value.trim()=='Range Value Per Period' ||  pfArray1['controls'][i].get('attributeNature').value.trim()=='Range Value Per Instance'">
                                          <input type="text" formControlName="value" class="form-control" name="Range"
                                            value="Range" disabled="true" [readonly]="true" placeholder="Enter Value">
                                        </td>

                                        <td class="wd-10"
                                          *ngIf="pfArray1['controls'][i].get('attributeNature').value.trim()=='List'">
                                          <select class="form-control  " formControlName="value">
                                            <option selected value=null>Select </option>
                                            <option *ngFor="let by of pfArray1['controls'][i].get('options').value"
                                              [value]="by.attributeOptionValue">
                                              {{by.attributeOptionValue}}
                                            </option>
                                          </select>
                                        </td>

                                        <td class="   p-d-inline-flex">
                                          <!-- ml-2 mr-2 mt-2  *ngIf="pfArray1['controls'][i].get('code').value.length!==0"-->
                                          <span
                                            (click)="copyDateFromTableRow(i,pfArray1['controls'][i].get('fromDate').value,pfArray1['controls'][i].get('toDate').value, pfArray1['controls'][i].get('toDate').value)"><i
                                              class="fa fa-clone text-blue font-16 mr-2 mt-2"></i></span>


                                          <input [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                                            formControlName="fromDate" data-provide="datepicker"
                                            [ngClass]="{'is-invalid' :pfArray1['controls'][i].get('fromDate').status == 'INVALID'}"
                                            (bsValueChange)="onChangeFromDate($event,i)"
                                            (focusout)="onChangeFromDate($event,i)" data-date-autoclose="true"
                                            class="form-control" placement="center" placeholder="From Date"
                                            bsDatepicker>
                                        </td>


                                        <td class="">
                                          <input [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                                            formControlName="toDate" data-provide="datepicker"
                                            [ngClass]="{'is-invalid' :pfArray1['controls'][i].get('toDate').status == 'INVALID'}"
                                            data-date-autoclose="true" class="form-control" placement="center"
                                            (bsValueChange)="onChangeToDate($event,i)"
                                            [minDate]="pfArray1['controls'][i].get('minDate1').value"
                                            placeholder="To Date" bsDatepicker>
                                        </td>
                                        <td class="wd-10">
                                          <input type="text" formControlName="value1" class="form-control"
                                            (focusout)="onChangeRangeFrom($event,i)"
                                            [ngClass]="{'is-invalid' :pfArray1['controls'][i].get('value1').status == 'INVALID'}"
                                            placeholder="Enter Value11">
                                        </td>
                                        <td class="wd-10">
                                          <input type="text" formControlName="value2" class="form-control"
                                            (focusout)="onChangeRangeTo($event,i)"
                                            [ngClass]="{'is-invalid' :pfArray1['controls'][i].get('value2').status == 'INVALID'}"
                                            placeholder="Enter Value22">
                                        </td>
                                        <td class="wd-10">
                                          <input type="text" formControlName="value3" class="form-control"
                                            [ngClass]="{'is-invalid' :pfArray1['controls'][i].get('value3').status == 'INVALID'}"
                                            placeholder="Enter Value33">
                                        </td>
                                        <td class="wd-10">
                                          <select class="form-control" formControlName="value4"
                                            [ngClass]="{'is-invalid' :pfArray1['controls'][i].get('value4').status == 'INVALID'}">
                                            <option selected value=''>Select </option>
                                            <option *ngFor="let activeFrequency of sortedFrequencyList"
                                              [value]="activeFrequency.id">
                                              {{activeFrequency.name}}
                                            </option>
                                          </select>
                                        </td>
                                        <!-- <td class="wd-10">
                                          <span *ngIf="pfArray1['controls'][i].get('isPlusSignVisible').value">
                                            <i style="font-size: 12;" class="fa fa-plus-circle font-12 cursor-pointer"
                                              tooltip="Add Row"
                                              (click)="addRow(i+1,pfArray1['controls'][i].get('attributeMasterId1').value)"></i><span
                                              tooltip="Add Row"
                                              (click)="addRow(i+1,pfArray1['controls'][i].get('attributeMasterId1').value)">&nbsp;Add</span>&nbsp;&nbsp;&nbsp;&nbsp;
                                          </span>


                                          <i style="font-size: 12;"
                                            *ngIf="pfArray1['controls'][i].get('code').value.length==0"
                                            class="fa fa-trash-o  font-12 text-red cursor-pointer" tooltip="Delete Row"
                                            (click)="deleteRow(i)">&nbsp;Delete</i>
                                        </td> -->
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>




                <div class="modal-footer"></div>

              </ng-template>



              <div class="row">
                <div class="col-md-10">
                  <div class="cycle-table mt-4">
                    <h3 class="font-14 text-purple font-bold">Summary</h3>
                    <!-- <p-table [value]="originalPayrollHeadGroupList" [paginator]="true" [rows]="10"
                      [showCurrentPageReport]="true"
                      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                      [rowsPerPageOptions]="[10,25,50,100,200]"> -->

                      <p-table [value]="originalPayrollHeadGroupList" [paginator]="true" [rows]="10"
                      [showCurrentPageReport]="true" [pageLinks]="5" (onPage)="paginate($event)"
                      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                      totalRecords={{originalPayrollHeadGroupList.length}} [rowsPerPageOptions]="[10,25,50,100,200]">


                      <ng-template pTemplate="header">
                        <tr>

                          <th rowspan="1" class="wd-8 text-center">
                            Sr. No.
                          </th>
                          <th rowspan="1" class="wd-20">
                            <div class="p-d-flex p-jc-between p-ai-center">
                              Payroll Head Group Name
                              <div class="Sort_Filter_Position">
                                <p-sortIcon field="headGroupDefinitionName" pSortableColumn="headGroupDefinitionName">
                                </p-sortIcon>
                                <p-columnFilter field="headGroupDefinitionName" display="menu" class="p-ml-auto">
                                </p-columnFilter>
                              </div>
                            </div>
                          </th>

                          <th rowspan="1" class="wd-20">
                            <div class="p-d-flex p-jc-between p-ai-center">
                              Payroll Head Group Description
                              <div class="Sort_Filter_Position">
                                <p-sortIcon field="description" pSortableColumn="description"></p-sortIcon>
                                <p-columnFilter field="description" display="menu" class="p-ml-auto"></p-columnFilter>
                              </div>
                            </div>
                          </th>
                          <th rowspan="1" class="wd-15">
                            <div class="p-d-flex p-jc-between p-ai-center">
                              Attribute Group Name
                              <div class="Sort_Filter_Position">
                                <p-sortIcon field="attributeGroupName" pSortableColumn="attributeGroupName">
                                </p-sortIcon>
                                <p-columnFilter field="attributeGroupName" display="menu" class="p-ml-auto">
                                </p-columnFilter>
                              </div>
                            </div>
                          </th>



                          <th rowspan="1" class="wd-10">
                            <div class="p-d-flex p-jc-center p-ai-center">
                              Action
                            </div>
                          </th>
                        </tr>

                      </ng-template>



                      <ng-template pTemplate="body" let-user1 let-rowIndex="rowIndex">
                        <tr class="p-selectable-row">
                          <td class="bg-color-light_gray text-center"><label
                              class="form-lable mb-0">{{rowIndex+1}}</label></td>
                          <!-- <td class="bg-color-light_gray text-center"><label
                              class="form-lable mb-0">{{user1.headGroupDefinitionId}}</label></td> -->

                          <td class="bg-color-light_gray"><label
                              class="form-lable mb-0">{{user1.headGroupDefinitionName}}</label></td>
                          <td class="bg-color-light_gray"><label class="form-lable mb-0">{{user1.description}} </label>
                          </td>
                          <td class="bg-color-light_gray"><label class="form-lable mb-0">{{user1.attributeGroupName}}
                            </label></td>

                          <td class="wd-10 align-left">

                            <button type="button" class="btn btn-icon text-blue" tooltip="Edit"
                              (click)="GetPHGByIdDisable(user1.headGroupDefinitionId)">
                              <i class="fa fa-edit"></i></button>

                            <button type="button" (click)="UploadModal1(template22,user1.headGroupDefinitionId);"
                              class="btn btn-icon js-sweetalert text-blue" tooltip="Delete" data-type="confirm"><i
                                class="fa fa-trash-o"></i></button>
                          </td>
                        </tr>
                      </ng-template>
                      <ng-template pTemplate="emptymessage">
                        <tr>
                          <td colspan="15" class="font-14 font500 text-center text-red"><span>No Data
                              Available</span></td>
                        </tr>
                      </ng-template>
                    </p-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <app-footer></app-footer>
</div>
