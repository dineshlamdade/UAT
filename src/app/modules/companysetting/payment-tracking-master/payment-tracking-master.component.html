<app-leftmenu></app-leftmenu>
<!-- Main body part  -->
<div class="page">
    <app-header></app-header>
    <div class="section-body mt-3">
      <div class="container-fluid" style="border: 1px solid #ccc; background-color: #fff;">
        <div class="tabview-contents">
          <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="card-body p-0">
                  <form [formGroup]="paymenttrackingForm"  (ngSubmit)="paymentTrackingFormSubmit()" #formDirective="ngForm">
                    <div class="col-12 mt-10">
                      <!-- Payment Tracking-->
                      <div class="mb-0">
                        <h3 class="font-14 text-purple font-bold">Payment Tracking</h3>
                      </div>
                            <div class="row mt-10">
                                <div class="col-sm-3">
                                  <label class="form-label"> Code</label>
                                  <input type="text" class="form-control" formControlName="code" [maxlength]="25"
                                  placeholder=""
                                  onkeypress="return /[0-9a-zA-Z%@#/_]/i.test(event.key)"

                               >
                                </div>
        
                                <div class="col-sm-3">
                                  <label class="form-label">Description</label>
                                  
                                 <input type="text" class="form-control" formControlName="description" [maxlength]="50"
                                 placeholder=""
                                 onkeypress="return /[0-9a-zA-Z%@#/_ ']/i.test(event.key)"  > 
        
                                </div>
        
                                <div class="col-sm-3">
                                  <label class="form-label">  Copy From</label>
                                  <select name="Select" class="form-control" placeholder="Select">
                                    <option value="Select"> Select </option>                                      
                                    <option value=""> </option>
                                    <option value=""> </option>
                                    <option value=""> </option>
                                </select>
                                   </div>
        
                           
        
        
                              </div> <!-- end of row -->                   
                              <br>
                              <!-- Nature -->
                              <fieldset style="margin-top:-20px;">
                                <legend>Nature</legend>
                                <div class="row mt-10" style="margin-top:-15px;">
                                    <div class="col-sm-4">
                                      <label class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" class="custom-control-input" name="nature"
                                        formControlName="nature" value="option1" checked>
                                          <span class="custom-control-label">Employee Payments</span>
                                     </label>
                                  
                                      </div>
                                      <div class="col-sm-4">
                                    

                                      <label class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" class="custom-control-input" name="nature"
                                        formControlName="nature" value="option2" >
                                          <span class="custom-control-label">Compliance</span>
                                     </label>
                                    </div> 
                                     <div class="col-sm-4">
                                    
                                      <label class="custom-control custom-radio custom-control-inline">
                                        <input type="radio" class="custom-control-input" name="nature"
                                        formControlName="nature" value="option3" >
                                          <span class="custom-control-label">Garnishment / Third Party Payments
                                          </span>
                                     </label>
                                    </div> 
                                  </div> <!-- end of row -->
                                
                                  <div class="container">
                                    <div class="column column-two"> 
                                      <div class="row mt-10">
                                      <div class="col-sm-5">
                                      <label class="form-label">Module</label>
                                      <select name="Select" class="form-control text-center" formControlName="moduleId"
                                     >
                                        <option value="Select"> Select </option>
                                        <option *ngFor="let applicationModule of applicationModuleNameList" [value]="applicationModule.moduleId"  >
                                          {{applicationModule.applicationModuleName}}
                                        </option>
                                </select>

                                    </div>
                                    <div class="col-sm-5">

                                      <label class="form-label">Payment Mode</label>
                                      <select name="Select" class="form-control">
                                        <option value="Select"> Select </option>                                      
                                        <option value="">Cheque </option>
                                        <option value="">Bank Transfer </option>
                                        <option value=""> Cash</option>
                                    </select>
                                    </div>
                                  </div>
                                  </div>
                                    <div class="column column-one">
                                      <div class="row mt-10">
                                      <div class="col-sm-6">
                                        <label class="form-label">Compliance Head</label>
                                        <select name="Select" class="form-control" formControlName="complianceHead" (change)="onSelectComplianceMaster($event.target.value)">
                                          <option value="Select"> Select </option>   
                                          <option  *ngFor = "let complianceHeadName of complianceHeadList"
                                           [value]="complianceHeadName.complianceHeadId">                                   
                                         {{complianceHeadName.complianceHeadName}}
                                         </option>
                                      </select>
  
                                      </div>
                                      <div class="col-sm-6">
                                        <label class="form-label">Compliance Master</label>
                                        <select name="Select" class="form-control" formControlName="complianceMaster">
                                          <option value="Select"> Select </option>                                      
                                          <option  *ngFor = "let complianceName of complianceMasterList" [value]="complianceName.complianceMasterId">
                                            {{complianceName.complianceName}}
                                          </option>
                                      </select>
  
                                      </div>
                                    </div>
                                    </div>
                                   
                                    <div class="column column-three">
                                      <div class="row mt-10" >
                                        <div class="col-sm-7" style="margin-right: -30px;">
                                          <label class="form-label">Payee Name</label>
                                          <select name="Select" class="form-control" formControlName="description">
                                            <option *ngFor = "let description of garnishmentDetailsList" [value]="description.description">                                       
                                            {{description.description}}</option>
                                          
                                        </select>
                                          </div>
                                          </div>
                                    </div>
                                    
                                 </div>
                                 
                                 
                                
                       </fieldset>
                       <br>
                       <br>
                       <!-- Additional Payment in Voucher -->
                       <fieldset style="margin-top:-20px;">
                        <legend>Additional Payments in Voucher</legend>
                       
                        <div class="col-md-7">
                          <div class="mb-0">
                            <h3 class="font-14 text-purple font-bold"></h3>
                          </div>
                          <div class="table-responsive Custom_Table">
                            <table class="table table-striped table-hover table-bordered m-b-0">
                                <thead class="thead-dark">
                                    <tr>
                                        <th class="wd-20 font700">S NO</th>
                                        <th class="wd-20 font700">Head</th>
                                        <th class="wd-20 font700" >Logic</th>
                                        <th class="wd-20 font700" *ngIf="logicValue !='Input'">Formula Value</th>
                                        <th class="wd-30 font700">Action</th>
                                   </tr>

                                </thead>

                                <tbody>
                                    
                                    <tr >
                                      <td>
                                        1
                                      </td>
                                      <td>
                                        <input type="text" class="form-control"  formControlName="payHead"  
                                      ></td>

                                        <td >  <select  class="form-control custom-select"
                                            formControlName="logicMethod" (change)="onSelectFormula($event.target.value)">
                                          <option>Select</option>
                                             <option value="Input" > Input</option>
                                             <option value="Formula" >Formula</option>
                                             </select></td>
                                         <td *ngIf="logicValue !='Input'">
                                           
                                          <select  class="form-control custom-select"
                                            formControlName="formulaMasterId">
                                          <option *ngFor="let formula of formulaName" [value]="formula.formulaId">{{formula.formulaName}}</option>
                                             
                                             </select>
                                        </td>

                                        <td> 
                                            <i
                                            class="fa fa-plus-circle align-right font700 font-16 text-light-green cursor-pointer"
                                      
                                        tooltip="Add"
                                        (click)="addTableVoucher()"
                                      ></i>&nbsp;&nbsp;
                                   
                                    </td>
                                    </tr>
                                   
                                    <tr *ngFor="let rowAddV of rowV; let i = index;" >
                                        
                                        <td><span tooltip="{{i+1}}">{{i+1}}</span>
                                           </td>
                                           <td>
                                            <input class="form-control custom-select" disabled value="{{rowAddV.Head}}">
                                                 </td>
                                       
                                  <td><input class="form-control custom-select" disabled value="{{rowAddV.Logic}}"></td>
                                       
                                        <td *ngIf="logicValue !='Input'">
                                          
                                          <input class="form-control custom-select" disabled value="{{rowAddV.FormulaValue}}">
                                            <!-- <select  class="form-control custom-select " disabled
                                            formControlName="formulaName">
                                          <option *ngFor="let formula of formulaName" [value]="rowAddV.formulaId">{{rowAddV.FormulaValue}}</option>
                                             
                                             </select> -->
                                        </td>
                                       
                                        <td>
                                           
                                           
                                          <i 
                                          class="fa fa-times font-16 text-red cursor-pointer"
                                          tooltip="Cancel"
                                          (click)="deleteRowsV(rowAddV,i)"
                                        ></i></td>
                                    </tr>
                                   
                                </tbody>
                            </table>
                        </div>
  
                    </div>
                
                  </fieldset>
                  <br>
                  <br>
                  <!-- Dropdown Fields -->
                  <div class="row mt-10">
                    <div class="col-sm-3">
                      <label class="form-label"> Automatic Creation of Payments Voucher &nbsp;&nbsp; &nbsp;  &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</label>
                      <select name="custom-select" class="form-control" formControlName="autoCreaPayVouch">
                        <option value="Select">Select</option>
                        <option value="yes"> Yes</option>
                        <option value="no">No</option>
                        </select> 
                    </div>

                    <div class="col-sm-3">
                      <label class="form-label">Option to Pay at one go for more than one Processing Cycles</label>
                      <select name="custom-select" class="form-control" formControlName="payMoreOneProcCyOneGo">
                        <option value="Select">Select</option>
                        <option value="Yes"> Yes</option>
                        <option value="No"> No</option>
                        </select> 

                    </div>

                    <div class="col-sm-3">
                      <label class="form-label"> Option to Pay at one go for more than one Pertaining Cycles</label>
                      <select name="custom-select" class="form-control" formControlName="payMoreOnePertainCyOneGo">
                        <option value="Select">Select</option>
                        <option value="Yes"> Yes</option>
                        <option value="No"> No</option>
                        </select> 
                     </div>
                     <div class="col-sm-3">
                      <label class="form-label">Option to Pay Partial Amount
                       </label><br>
                      <select name="custom-select" class="form-control" formControlName="partPay">
                        <option value="Select">Select</option>
                        <option value="Yes"> Yes</option>
                        <option value="No"> No</option>
                        </select> 
                     </div>
               


                  </div> 
                   <br>
                   <div class="row mt-10">
                    <div class="col-sm-3">
                      <label class="form-label"> Job Field</label>
                      <select name="custom-select" class="form-control" formControlName="jobMasterType"
                       (change)="onSelectJobFieldValue($event.target.value)">
                        <option value="Select">Select</option>
                        <option  *ngFor = "let jobMasterType of jobMasterList" [value]="jobMasterType.jobMasterId">
                          {{jobMasterType.jobMasterType}}
                        </option>
                        </select> 
                    </div>

                    <div class="col-sm-3" *ngIf = "jobMasterMappingList">
                      <label class="form-label">Job Field Value</label>
      
                      <p-multiSelect 
                       [options]="jobMasterMappingList"
                       class="multiselect-custom"
                      [showHeader]="true" 
                     
                      [virtualScroll]="true"
                        formControlName="jobFieldValue"
                       [filterPlaceHolder]="'Select'"
                        [placeholder]="'Select Template'"
                         ngDefaultControl >
                      </p-multiSelect>

                    
                        
                    </div>

                    <div class="col-sm-3">
                      <label class="form-label">Approval Workflow</label>
                      <select name="custom-select" class="form-control" formControlName="workflowMasterHeaderId">
                        <option value="Select">Select</option>
                        <option  *ngFor = "let workFlow  of workFlowList" [value]="workFlow.workflowMasterHeaderId">                                   
                          {{workFlow.workflowCode}}
                          </option>
                        </select> 
                     </div>
                     <div class="col-sm-3">
                      <label class="form-label"> Approval SDM</label>
                      <select name="custom-select" class="form-control" formControlName="approvalSDMId">
                        <option value="Select">Select</option>
                        <option *ngFor="let sdm of sdmApproval" [value]="sdm.sdmSchemaName">{{sdm.sdmSchemaName}}</option>
                      
                        </select> 
                     </div>
               


                  </div>  
                  <br>
                 
                  <div class="row mt-10">
                   
                     <div class="col-sm-3">
                      <label class="form-label"> Remark</label>
                      <input type="text" class="form-control" placeholder="" formControlName="remark" >
                     </div>
                  </div>

                  <br>
                  <br>
                  <!-- bank details -->
                  
                  <fieldset style="margin-top:-20px;">
                    <legend>Bank Details</legend>
                    <div class="col-md-8">
                      <div class="mb-0">
                        <h3 class="font-14 text-purple font-bold"></h3>
                      </div>
                      <div class="col-md-12 mt-10">
                        <div class="table-responsive Custom_Table">
                            <table class="table table-striped table-hover table-bordered m-b-0">
                                <thead class="thead-dark">
                                    <tr>
                                        <th class="wd-10 font700">S NO</th>
                                        <th class="wd-10 font700">Bank</th>
                                        <th class="wd-20 font700">IFCS</th>
                                        <th class="wd-20 font700">Bank Name</th>
                                        <th class="wd-20 font700">Branch Name</th>
                                        <th class="wd-20 font700">Account No</th>
                                        <th class="wd-10 font700">Default</th>
                                        <th class="wd-30 font700">Action</th>

                                    </tr>

                                </thead>

                                <tbody>
                                    
                                    <tr *ngFor = "let bankDetails of bankDetailssummary,let i = index; ">
                                       <td>{{i+1}}</td>
                                       <td><p-button [label]="selectedProduct ? selectedProduct.name : 'Select a Bank'" 
                                        icon="pi pi-search" (click)="op.toggle($event)"></p-button></td>

                                        <td>{{bankDetails.ifscCode}} </td>
                                        
                                          <td>{{bankDetails.bankName}}</td>

                                          <td>{{bankDetails.branchName}}</td>

                                          <td>{{bankDetails.accountNumber}}</td>
                                          <td><input type="checkbox" class="form-control"    formControlName="active"
                                            ></td>
                                          
                                       
                                        <td> 
                                            <i
                                            class="fa fa-plus-circle align-right font700 font-16 text-light-green cursor-pointer"
                                      
                                        tooltip="Add"
                                        (click)="addTable()"
                                      ></i>&nbsp;&nbsp;
                                            
                                    
                                         
                                    </td>
                                    </tr>
                                    <!-- <pre>{{row | json}}</pre> -->
                                    <tr *ngFor="let rowAdd of row; let i = index;" >
                                        
                                        <td>
                                           </td>
                                        <td><input class="form-control custom-select" disabled value="{{rowAdd.ifscCode}}"></td>
                                        <td>
                                          <input class="form-control custom-select" disabled value="{{rowAdd.bankName}}">
                                             </td>
                                        <td>
                                       <input class="form-control custom-select" disabled value="{{rowAdd.branchName}}">
                                            </td>
                                        <td>
                                          
                                            <input class="form-control custom-select" disabled value="{{rowAdd.accountNumber}}">
                                        </td>
                                        <td><input type="checkbox" class="form-control"    formControlName="active"
                                          ></td>
                                        <td>
                                           
                                           
                                          <i 
                                          class="fa fa-times font-16 text-red cursor-pointer"
                                          tooltip="Cancel"
                                          (click)="deleteRows(rowAdd.employeeRoleAssignmentId,i)"
                                        ></i></td>
                                    </tr>
                                   
                                </tbody>
                            </table>
                        </div>

                    </div>

                </div>
                      

                 </fieldset>

                 <p-overlayPanel #op [showCloseIcon]="true" [style]="{width: '450px'}">
                  <ng-template pTemplate>
                      <p-table [value]="bankData" selectionMode="single" [(selection)]="selectedProduct" (onRowSelect)="onRowSelect($event)" [paginator]="true" [rows]="5">
                          <ng-template pTemplate="header">
                              <tr>
                                  <th>IFCS Code</th>
                                  <th>Bank Name</th>
                                  <th>Branch Name</th>
                                  <th>Account Number</th>
                              </tr>
                          </ng-template>
                          <ng-template pTemplate="body" let-rowData let-bankData>
                              <tr [pSelectableRow]="rowData">
                                  <td>{{bankData.ifscCode}}</td>
                                  <td>{{bankData.bankName}}</td>
                                  <td>{{bankData.branchName}}</td>
                                  <td>{{bankData.mappingDetails.accountNumber}}</td>
                              </tr>
                          </ng-template>
                      </p-table>
                  </ng-template>
              </p-overlayPanel>
                
                 <br>
                 <!-- Button -->
                 <div class="row mt-20">
                  <div class="col-md-12">
                    <div class="float-right">
                      <ng-container class="float-right">
                        <div class="row float-right" style="margin: 10px" >
                          <button type="submit"  *ngIf="isShown" class="custom_button custom_btn btn-labeled btn-labeled-left"
                          tooltip="Save" [disabled]="!paymenttrackingForm.valid"
                           [ngClass]="{'disabled-btn-bg-green' : paymenttrackingForm.invalid,'btn-bg-green': !paymenttrackingForm.invalid}">
                           <b> <i class="fa fa-floppy-o" aria-hidden="true"></i></b>Save</button
                          >&nbsp;
    
                          <button type="button"  tooltip="Reset" *ngIf="isShown" class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left ml-10" (click)="reset()">
                            <b><i class="fa fa-refresh" aria-hidden="true"></i></b>Reset</button
                          >&nbsp;
                          <button type="submit" tooltip="Update" *ngIf="isVisible"  class="custom_button custom_btn btn-labeled btn-labeled-left btn-bg-green"
                          >
                           <b> <i class="fa fa-floppy-o" aria-hidden="true"></i></b>Update</button
                          >&nbsp;
    
                          <button type="button" tooltip="Cancel" *ngIf="isVisible" class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left ml-10" (click)="cancel()" >
                           <b> <i class="fa fa-times-circle"  aria-hidden="true"></i></b>Cancel</button>
                        </div>
                      </ng-container>
                      
                      <!-- <button
                        type="submit" tooltip="Button" class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left mr-10">
                        <b><i class="fa fa-save"></i></b> Save
                      </button>
                      <button  type="button" tooltip="Reset" class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left" (click)="reset()">
                        <b><i class="fa fa-refresh"></i></b> Reset
                      </button> -->
                    </div>
                  </div>
                </div>

              <br>
              <!-- summary -->
              <div class="mb-0" style="margin-left:10px;">
                <h3 class="font-14 text-purple font-bold">Summary</h3>
              </div>
                <div class="col-md-8">
                  <div class="mb-0">
                    <h3 class="font-14 text-purple font-bold"></h3>
                  </div>
             <p-table [value]="summary" >
                  <ng-template pTemplate="header">
                    <tr>
                      <th rowspan="2" class="wd-8 text-center">Sr. No.

                      </th>
                     
                     <th rowspan="2" class="wd-8 text-center">
                      <div class="p-d-flex p-jc-between p-ai-center">Code

                      <div class="Sort_Filter_Position">
                        <p-sortIcon field="representative.name"></p-sortIcon>
                 <p-columnFilter type="text" field="Desc"  display="menu" class="p-ml-auto">
                 </p-columnFilter>
                      </div>
                      </div>
                    </th>
                    <th rowspan="2" class="wd-8 text-center">
                     <div class="p-d-flex p-jc-between p-ai-center">Description

                     <div class="Sort_Filter_Position">
                     <p-sortIcon field="date"></p-sortIcon>
                <p-columnFilter type="date" field="date" display="menu" class="p-ml-auto">   
                    </p-columnFilter>
                    </div>
                    </div>
                   </th> 

                   <th rowspan="2" class="wd-8 text-center">
                    <div class="p-d-flex p-jc-between p-ai-center">Nature

                    <div class="Sort_Filter_Position">
                    <p-sortIcon field="date"></p-sortIcon>
               <p-columnFilter type="date" field="date" display="menu" class="p-ml-auto">  
                    </p-columnFilter>
                   </div>
                   </div>
                  </th>
 
                  
                  <th rowspan="2" class="wd-8 text-center">
                    <div class="p-d-flex p-jc-between p-ai-center">Remark

                    <div class="Sort_Filter_Position">
                    <p-sortIcon field="date"></p-sortIcon>
               <p-columnFilter type="date" field="date" display="menu" class="p-ml-auto">  
                    </p-columnFilter>
                   </div>
                   </div>
                  </th>
                 
                   <th rowspan="2" class="wd-8 text-center"> Action 

                   </th>
                <!-- <th rowspan="2"></th> -->
                </tr>
              
               </ng-template>
              <ng-template pTemplate="body" let-summary let-rowIndex="rowIndex">
                 <tr class="p-selectable-row">
                    <td class="text-center"> {{rowIndex + 1}}</td>
                 
                   <td class="bg-color-light_gray">
                  {{summary.code}}
                      </td>
                  <td class="bg-color-light_gray">
                     
                   {{summary.description}}
                </td>
                <td class="bg-color-light_gray">
                 {{summary.nature}}
             </td>


             <td class="bg-color-light_gray">
             {{summary.remark}}
         </td>
       
             <td>
              <i class="fa fa-edit font-16 text-blue cursor-pointer" tooltip="Edit" (click)="editSummary()"></i> &nbsp;&nbsp;
              <i class="fa fa-eye font-16 text-blue cursor-pointer" tooltip="View" (click)="viewSummary()"></i> &nbsp;&nbsp;
              <i class="fa fa-trash-o font-16 text-red cursor-pointer" tooltip="Delete" (click)="deleteSummary()"></i> &nbsp;
            </td>
               
             </tr>
             </ng-template>
             <ng-template pTemplate="emptymessage">
                  <tr>
                   <td colspan="15" class="font-14 font500 text-center text-red"><span>No Data
                                 Available</span>
                   </td>
                  </tr>
             </ng-template>
             </p-table>

            </div>
            <br>
          
            
                   <!-- </fieldset>  -->
                    
                 
                </div>
                </form>
              </div> <!-- card body -->
               
          </div>
        </div>


       </div>
     </div>
    <app-footer></app-footer>
   </div>
</div>
</div>


<ng-template #template>
  <div class="modal-header">
      <h5 class="modal-title" id="UploadModalLabel">Full Page Dialog</h5>
      <button type="button" (click)="modalRef.hide()" class="close" data-dismiss="modal" aria-label="Close"><span
      aria-hidden="true">×</span></button>
  </div>
  <div class="modal-body">
      <div class="card">
          <div class="card-body">
              <div class="row clearfix">
                  <div class="col-md-12">
                      <h4>Full Page Popup</h4>
                  </div>
              </div>
          </div>
      </div>
  </div>
  <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modalRef.hide()">Ok</button>
  </div>
</ng-template>
