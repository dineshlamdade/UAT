<app-leftmenu></app-leftmenu>
<div class="page">
  <app-header></app-header>
  <div class="section-body mt-3">
    <div class="container-fluid">


      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-body" style="border:1px solid rgb(189, 175, 175)">
              <form [formGroup]="addRescheduleForm">
                <fieldset>
                  <legend>Employee Details</legend>
                  <div class="row" *ngIf="perticularEmpDetails">
                    <div class="col-md-12 pl-0 pr-0">
                      <div class="border-dark-card radius-10 p-2">
                        <div class="row">
                          <div class="col-md-2">
                            <label class="form-label mt-1 mb-0">Employee No. & Name </label>
                            <label class="font-12 text-ellipsis mt-1 mb-0" value="">{{perticularEmpDetails.employeeCode
                              +' - '+ perticularEmpDetails.fullName}}</label>
                          </div>
                          <div class="col-md-2">
                            <label class="form-label mt-1 mb-0">Date of Joining</label>
                            <label class="font-12 text-ellipsis mt-1 mb-0">{{perticularEmpDetails.joiningDate|date:
                              'dd-MMM-yyyy'}}</label>
                          </div>
                          <div class="col-md-2">
                            <label class="form-label mt-1 mb-0">Establishment</label>
                            <label
                              class="font-12 text-ellipsis mt-1 mb-0">{{perticularEmpDetails.establishment}}</label>

                          </div>
                          <div class="col-md-2">
                            <label class="form-label mt-1 mb-0">Department</label>
                            <label class="font-12 text-ellipsis mt-1 mb-0">{{perticularEmpDetails.employeeType}}</label>

                          </div>
                          <div class="col-md-1">
                            <label class="form-label mt-1 mb-0">Grade</label>
                            <label class="font-12 text-ellipsis mt-1 mb-0">{{perticularEmpDetails.grade}}</label>

                          </div>
                          <div class="col-md-2">
                            <label class="form-label mt-1 mb-0">Designation</label>
                            <label class="font-12 text-ellipsis mt-1 mb-0">{{perticularEmpDetails.designation}}</label>
                            <!-- <input type="text" class="form-control"  value="UI Developer" disabled /> -->

                          </div>
                          <div class="col-md-1">
                            <label class="form-label mt-1 mb-0">Status</label>
                            <label class="font-12 text-ellipsis mt-1 mb-0">{{perticularEmpDetails.status}}</label>
                            <!-- <input type="text" class="form-control"  value="Probation" disabled /> -->
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </fieldset>
                <!-- </div> -->

                <!-- <div class="col-md-12 pl-0 pr-0">
                  <div class="border-dark-card radius-10 p-2 mt-3">
                    <div class="row">
                      <div class="col-md-3">
                        <label class="form-label mt-1 mb-0" >Emp.Code</label >
                         <input type="text" class="form-control"  value="{{perticularEmpDetails.employeeCode  +''+  perticularEmpDetails.fullName}}"
                          disabled />
                      </div>
                      <div class="col-md-3">
                        <label class="form-label mt-1 mb-0">Emp.Name</label  >

                        <input type="text" class="form-control" value="{{perticularEmpDetails.establishment}}" disabled />
                      </div>
                      <div class="col-md-3">
                        <label class="form-label mt-1 mb-0">Loan No.</label>
                        <input type="text" class="form-control" value="{{perticularEmpDetails.employeeType}}"  disabled />
                      </div>
                      <div class="col-md-3">
                        <label class="form-label mt-1 mb-0">Application Date</label >
                        <input type="text" class="form-control" value="{{perticularEmpDetails.joiningDate|date: 'dd-MMM-yyyy'}}"
                         disabled />
                      </div>


                    </div>
                  </div>
                </div> -->
                <!-- </fieldset> -->
                <br>
                <fieldset>
                  <legend>Loan Details</legend>
                  <div class=" row" *ngIf="loanDetails">
                  <div class="col-md-12 pl-0 pr-0">
                    <div class="border-dark-card radius-10 p-2">
                      <div class="row">
                        <div class="col-md-3">
                          <label class="form-label">Loan Type</label>
                          <input type="text" class="form-control" value="{{loanDetails.loanType}}" disabled />
                        </div>
                        <div class="col-md-3">
                          <label class="form-label">Description</label>
                          <input type="text" class="form-control" value="{{loanDescription}}" disabled />
                        </div>
                        <div class="col-md-3">
                          <label class="form-label ">Loan No.</label>
                          <input type="text" class="form-control" value="{{loanDetails.loanApplicationNumber}}" disabled />
                        </div>
                        <div class="col-md-3">
                          <label class="form-label">
                            Application Date
                          </label>

                          <div class="form-group mb-0  mt-1 SMDatepickerWidth" >
                            <div class="input-group">
                              <div class="input-group-prepend">
                                <span class="input-group-text">
                                  <i class="fa fa-calendar"></i>
                                </span>
                              </div>
                              <input data-provide="datepicker" data-date-autoclose="true" class="form-control"
                              placeholder="Date" value="{{loanDetails.createDateTime|date:
                                'dd-MMM-yyyy'}}" bsDatepicker disabled>
                            </div>
                          </div>
                        </div>
                    </div>
                      <br>

                      <div class="row">
                        <div class="col-md-3">
                          <label class="form-label">Repayment Type</label>
                          <input type="text" class="form-control"  value="{{loanDetails.repaymentType}}" disabled />
                        </div>
                        <div class="col-md-3">
                          <label class="form-label">Payroll Area</label>
                          <input type="text" class="form-control" value="{{loanDetails.payrollArea}}" disabled />
                        </div>
                        <!-- <div class="col-md-3">
                          <label class="form-label">Scheduled EMI</label>
                          <input type="text" class="form-control" value="{{loanDetails.loanAmount}}" disabled />
                        </div> -->
                        <div class="col-md-3">
                          <label class="form-label">Loan Balance</label>
                          <!-- <input type="text" class="form-control" value="{{balance}}" placeholder="Loan Balance" disabled /> -->
                          <p-inputNumber class="p-inputleft" [(ngModel)]="balance" [ngModelOptions]="{standalone: true}" disabled="isEditable"
                          mode="decimal" locale="en-IN" [minFractionDigits]="2"
                         max="100" [step]="2.5" maxlength="5"></p-inputNumber>
                        </div>

                        <div class="col-md-3" *ngIf="scheduledEMI">
                          <label class="form-label">Scheduled EMI</label>
                          <!-- <input type="text" class="form-control" value="{{scheduleEmi}}"  placeholder="Scheduled EMI" disabled /> -->
                          <p-inputNumber class="p-inputleft" [(ngModel)]="scheduleEmi" [ngModelOptions]="{standalone: true}" disabled="isEditable"
                          mode="decimal" locale="en-IN" [minFractionDigits]="2"
                         max="100" [step]="2.5" maxlength="5"></p-inputNumber>
                        </div>

                        <div class="col-md-3" *ngIf="schedulePriRepayment">
                          <label class="form-label">Scheduled Principal Repayment</label>
                          <!-- <input type="text" class="form-control" value="{{propsedPrincipal}}" placeholder="Schedule Principal Repayment" disabled /> -->
                          <p-inputNumber class="p-inputleft" [(ngModel)]="propsedPrincipal" [ngModelOptions]="{standalone: true}" disabled="isEditable"
                          mode="decimal" locale="en-IN" [minFractionDigits]="2"
                         max="100" [step]="2.5" maxlength="5"></p-inputNumber>
                        </div>
                      </div>
                      <br>
                      <div class="row">
                        <div class="col-md-3">
                          <label class="form-label"> Remaining No. Of Installments</label>
                          <input type="text" class="form-control" placeholder="No. Of Installment"  value="{{remainingInstallment}}"  disabled />
                        </div>
                        </div>

                      <br />
                    </div>
                  </div>
                  </div>
                </fieldset>
                <br>
                <fieldset>
                  <legend>Rescheduling Details</legend>
                  <div class="col-md-12 pl-0 pr-0">
                    <div class="border-dark-card radius-10 p-2 ">
                      <div class="row">
                        <div class="col-md-3">
                          <label class="form-label">Transaction No.</label>
                          <input type="text" class="form-control" formControlName="transactionNo" placeholder="Transaction No." disabled />
                        </div>

                        <div class="col-md-3">
                          <label class="form-label">
                            Application Date
                          </label>
                          <div class="form-group mb-0  mt-1 SMDatepickerWidth" disabled>
                            <div class="input-group">
                              <div class="input-group-prepend">
                                <span class="input-group-text">
                                  <i class="fa fa-calendar"></i>
                                </span>
                              </div>
                              <input data-provide="datepicker" data-date-autoclose="true" class="form-control"
                                placeholder="Date" bsDatepicker value="{{myDate |date:
                                  'dd-MMM-yyyy'}}" disabled>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-3">
                        <label class="form-label ">Rescheduling Type</label>
                        <select class="form-control" placeholder="Select" *ngIf="normalreschduletype" formControlName="rescheduleType" (change)="rescheduleTypeChg($event.target.value)">
                        <option  value=''>Select </option>
                        <option  value='No of Instalments to Reschedule'>No. of Instalments to Reschedule</option>
                        <option  value='Till Loan End'>Till Loan End </option>
                        </select>
                        <select class="form-control" placeholder="Select" formControlName="rescheduleType" *ngIf="loanapprovaltimereschduletype">
                          <option [value]="rescheduleType">{{rescheduleType}} </option>
                          </select>
                        </div>
                        <div class="col-md-3" *ngIf="noOfIntsallmentShow">
                          <label class="form-label">No. Of Installments to Reschedule</label>
                          <input type="text" class="form-control" formControlName="noOfInstallmentToReschedule" (focusout)="notGreterthanRemainingNoOdInstall($event.target.value)"
                          [ngClass]="{'is-invalid' : addRescheduleForm.get('noOfInstallmentToReschedule').status == 'INVALID' || amountisnotgraterthan} "
                          />
                        </div>
                        <div class="col-md-3" *ngIf="noOfIntsallmentHide">
                          <label class="form-label">No. Of Installments to Reschedule</label>
                          <input type="text" class="form-control" formControlName="noOfInstallmentToReschedule"  disabled
                         />
                        </div>
                      </div>
                      <br>
                      <div class="row mt-1 mb-0">

                        <div class="col-md-3">
                          <label class="form-label">Effective From</label>
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">
                                <i class="fa fa-calendar"></i>
                              </span>
                            </div>
                            <input data-provide="datepicker" data-date-autoclose="true" class="form-control"
                              placeholder="Date" bsDatepicker [bsConfig]="{ dateInputFormat: 'DD-MMM-YYYY' }"
                               [minDate]="myDate"  formControlName="expectedPaymentDate"  [disabled]="viewMode" >
                          </div>
                        </div>

                        <div class="col-md-3" *ngIf="proPriRepayment">
                          <label class="form-label">Proposed Principal Repayment (Per Installment)</label>
                          <!-- <input type="text" class="form-control" placeholder="Proposed Principal Pepayment " formControlName="propsedPrincipal"
                          [ngClass]="{'is-invalid' : addRescheduleForm.get('propsedPrincipal').status == 'INVALID'}"/> -->
                          <p-inputNumber class="p-inputright " formControlName="propsedPrincipal" name=" propsedPrincipal"
                           mode="decimal" locale="en-IN" [minFractionDigits]="2"
                          min="0"></p-inputNumber>
                          <!--  [class.is-invalid]="addRescheduleForm.get('propsedPrincipal').status == 'INVALID'"-->
                        </div>

                        <div class="col-md-3" *ngIf="proposedEMI">
                          <label class="form-label">Proposed EMI</label>
                          <!-- <input type="text" class="form-control" placeholder="Proposed Emi" formControlName="propsedEMI"
                          [ngClass]="{'is-invalid' : addRescheduleForm.get('propsedEMI').status == 'INVALID'}"/> -->
                          <p-inputNumber class="p-inputright" formControlName="propsedEMI" name=" propsedEMI"
                           mode="decimal" locale="en-IN" [minFractionDigits]="2"
                          min="0"></p-inputNumber>
                          <!--  [class.is-invalid]="addRescheduleForm.get('propsedEMI').status == 'INVALID'" -->
                        </div>

                        <div class="col-md-3">
                          <label class="form-label">Remark</label>
                          <textarea rows="1" type="text" class="form-control" placeholder="Remark" formControlName="remark" >
                          </textarea>
                        </div>

                      </div>
                      <br>

                    </div>
                  </div>
                </fieldset>

                <br><br>

                <div class="row mt-30" >
                  <div class="col-12">
                    <div class="card">
                      <div class="mb-0 row">
                        <div class="col-md-6">
                          <h3 class="font-14 text-purple font-bold">Approval Details</h3>
                        </div>
                        <!-- <div class="col-md-6 ">
                          <h6 class="font-12 mb-3 font-normal float-right">
                            <strong>Overall Status : </strong>&nbsp;&nbsp;
                            <strong class="btn-bg-green p-2">Pending </strong>
                          </h6>
                        </div> -->
                      </div>
                      <div class="row" >
                        <div class="col-md-12">
                          <div class="table-responsive Custom_Table">
                            <table class="table table-striped table-hover table-bordered m-b-0">
                              <thead class="thead-dark">
                                <tr>
                                  <th scope="col" class="font700 ">Level</th>
                                  <th scope="col" class="font700 ">Approver code</th>
                                  <th scope="col" class="font700 ">Approver Name</th>
                                  <th scope="col" class="font700 ">Action Date & Time</th>

                                  <th scope="col" class="font700 ">Status</th>
                                  <th scope="col" class="font700 ">Remark</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let approver of postApproverDetailsData">
                                  <td class="wd-9">{{approver.sequence}}</td>
                                  <td class="wd-14">{{approver.approverEmpCode}}</td>
                                  <td class="wd-14">{{approver.approverName}}</td>
                                  <td class="wd-14">Null</td>
                                  <td class="wd-14">Null</td>
                                  <td class="wd-14" *ngIf="inputnormalFlag">approved</td>
                                  <td class="wd-14" *ngIf="inputRemarkFlag"><input type="text"></td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <br><br>

                <ng-container class="float-right" *ngIf="loanAppBtns">

                  <div class="row float-right" style="margin: 10px">
                    <button type="button" tooltip="Save" *ngIf="isSave"
                      class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left ml-2 mr-2 "
                      aria-hidden="true" (click)="addRescheduleData()"  [disabled]="!addRescheduleForm.valid"
                      [ngClass]="{'disabled-btn-bg-green' : addRescheduleForm.invalid ,'btn-bg-green':
                      !addRescheduleForm.invalid }"><b><i class="fa fa-floppy-o"></i></b>Save
                    </button>

                        <button type="button" tooltip="Update" *ngIf="isUpdate"
                        [disabled]="!addRescheduleForm.valid"
                        [ngClass]="{'disabled-btn-bg-green' : addRescheduleForm.invalid ,'btn-bg-green':
                        !addRescheduleForm.invalid }"
                      class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left ml-2 mr-2"
                      aria-hidden="true"  (click)=" updateReschduleForm()" ><b><i class="fa fa-floppy-o"></i></b>Update
                    </button>

                <!-- <button type="button" tooltip="Send Back"
                class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left mr-10">
                <b><i class="fa fa-reply"></i></b> Send Back
              </button> -->
                <button type="button" tooltip="Close" (click)="close()"
                  class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left mr-10">
                  <b><i  class="fa fa-times-circle"></i></b> Close
                </button>
                <button type="button" tooltip="Reset" (click)="resetScheduleForm()"
                class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left mr-10">
                <b><i class="fa fa-refresh"></i></b> Reset
              </button>
                  </div>
                </ng-container>

                   <!-- .............................................edit time btns ...............................................  -->
                   <ng-container class="float-right"  *ngIf="loanApprEditTimeBtns">
                    <div class="row float-right" style="margin: 10px">

                    <button type="submit"
                    class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left ripple"
                    tooltip="Approved" ><b>
                        <i class="fa fa-check-square-o "></i></b> Approved
                    </button>&nbsp;

                    <button type="submit"
                    class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left ripple"
                    tooltip=" Send Back"><b>
                        <i class="fa fa-reply"></i></b> Send Back </button>&nbsp;

                   <!-- ...............................selected multiple employee buttons ..........................................   -->
                <button type="button" tooltip="Previous" class=" custom_button custom_btn bg-teal-400
                btn-labeled btn-labeled-left mr-2"*ngIf="multiplEmpFlag" > <b><i class="fa fa-angle-double-left" aria-hidden="true" >
                </i></b>Previous </button>

                <button type="button" tooltip="Next" class=" custom_button custom_btn bg-teal-400
                btn-labeled btn-labeled-left mr-2" *ngIf="multiplEmpFlag"> <b><i class="fa fa-angle-double-right"></i></b>
                Next</button>

                <button type="submit" *ngIf="multiplEmpFlag"
                class="custom_button custom_btn bg-btn-red btn-labeled btn-labeled-left ripple"
                tooltip=" Send Back & Next" ><b> <i class="fa fa-reply"></i>
                </b> Send Back & <i class="fa fa-angle-double-right"></i></button>&nbsp;

                <button type="submit" *ngIf="multiplEmpFlag"
                class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left ripple"
                tooltip="Approved & Next" ><b> <i class="fa fa-check-square-o "></i>
                </b> Approved & <i class="fa fa-angle-double-right"></i></button>&nbsp;

                <button type="button" tooltip="Forward & Next" *ngIf="multiplEmpFlag"
                class="custom_button custom_btn btn-bg-green btn-labeled btn-labeled-left ml-2 mr-2 "
                aria-hidden="true"><b><i class="fa fa-share"></i></b>Forward <i class="fa fa-angle-double-right"></i>
                </button>

                <button type="button" tooltip="Close"
                class="custom_button custom_btn bg-teal-400 btn-labeled btn-labeled-left mr-10">
                <b><i  class="fa fa-times-circle"></i></b> Close
              </button>

                  </div>
                </ng-container>
              </form>
            </div>
          </div>
        </div>
      </div>
      <app-footer></app-footer>
    </div>
  </div>
</div>
